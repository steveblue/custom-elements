var app=function(t){"use strict";const e=[{path:"/",component:"home-view"},{path:"/chapter-1",component:"chapter1-view"}];function n(t,e,n,o){var s,i=arguments.length,r=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(i<3?s(r):i>3?s(e,n,r):s(e,n))||r);return i>3&&r&&Object.defineProperty(e,n,r),r}const o=(...t)=>t,s=(...t)=>t,i=()=>{};class r{constructor(t){this.target=t,this.channels={default:new BroadcastChannel("default")},this.events={}}get(t){return this.events[t]}set(t,e){return this.events[t]=e,this.get(t)}emit(t){"string"==typeof t&&(t=this.events[t]),this.target.dispatchEvent(t)}broadcast(t,e){"string"==typeof t&&(t=this.events[t]),this.target.dispatchEvent(t),null===(t={type:t.type,detail:t.detail}).detail&&delete t.detail,e?this.channels[e].postMessage(t):this.channels.default.postMessage(t)}setChannel(t){this.channels[t]=new BroadcastChannel(t)}removeChannel(t){this.channels[t].close(),delete this.channels[t]}}function a(t){if(t)return e=>(function(t,e){e.prototype.elementMeta=Object.assign({},t),e.prototype.elementMeta.eventMap={},e.prototype.template=document.createElement("template"),e.prototype.template=`<style>${t.style}</style>${t.template}`,e.prototype.getEvent=function(t){return this.elementMeta.events[t]},e.prototype.setEvent=function(t,e){return this.elementMeta.events[t]=e}}(t,e),e);console.error("Component must include ElementMeta to compile")}function l(t,e){return function(n,o,s){const{onInit:a=i,onDestroy:l=i}=n,c=Symbol(o);n.onInit=function(){a.call(this),function(){const n=this[c]=((...t)=>{s.value.apply(this,t)});this.emitter||(this.emitter=new r(this),e&&(this.elementMeta.eventMap[t]={key:t,handler:o},this.emitter.channels[e].onmessage=(e=>{this[this.elementMeta.eventMap[t].handler](e.data)}))),this.addEventListener(t,n)}.call(this)},n.onDestroy=function(){l.call(this),function(){this.removeEventListener(t,this[c])}.call(this)}}}function c(t,e){const n=`${t.elementMeta.selector}`;if(!document.getElementById(`${n}-x`)){const e=document.createElement("style");e.setAttribute("id",`${n}-x`),e.innerText=t.elementMeta.style,e.innerText=e.innerText.replace(/:host/gi,`[is=${n}]`),document.head.appendChild(e)}}function u(t,e){return e||(e=[]),Array.from(function(t){return t.parentNode}(t).children).filter(t=>"TEXT"!==t.tagName&&"STYLE"!==t.tagName)}function m(t){return u(t).indexOf(t)}class p extends HTMLElement{constructor(){super(),function(t,e){const n=t.attachShadow(e||{}),o=document.createElement("template");o.innerHTML=t.template,n.appendChild(o.content.cloneNode(!0))}(this,{mode:"open"}),this.onInit&&this.onInit()}}class h extends HTMLButtonElement{constructor(){super(),function(t,e){const n=document.createElement("template");n.innerHTML=t.elementMeta.template,t.appendChild(n.content.cloneNode(!0))}(this),c(this),this.onInit&&this.onInit()}}class d extends HTMLInputElement{constructor(){super(),c(this),this.onInit&&this.onInit()}}var y,f;t.MyButtonComponent=class extends h{constructor(){super()}onClick(t){this.emitter.broadcast("bang")}onKeyUp(t){"Enter"===t.key&&this.emitter.broadcast("bang")}},n([(y="bang",f={bubbles:!0,composed:!0},function(t,e,n){const{onInit:o=i}=t;t.onInit=function(){o.call(this),function(){this.emitter||(this.emitter=new r(this)),this.emitter.set(y,new CustomEvent(y,f||{}))}.call(this)}}),l("click")],t.MyButtonComponent.prototype,"onClick",null),n([l("keyup")],t.MyButtonComponent.prototype,"onKeyUp",null),t.MyButtonComponent=n([a({selector:"my-button",template:o`<span>button</span>`,style:s`:host{background:#181818;cursor:pointer;color:#fff;font-weight:400}`})],t.MyButtonComponent),customElements.define("my-button",t.MyButtonComponent,{extends:"button"}),t.MyInputComponent=class extends d{constructor(){super()}onFocus(t){this.value="input"}},n([l("focus")],t.MyInputComponent.prototype,"onFocus",null),t.MyInputComponent=n([a({selector:"my-input",style:s`:host{background:#181818;border:0;color:#fff}`})],t.MyInputComponent),customElements.define("my-input",t.MyInputComponent,{extends:"input"}),t.MyListComponent=class extends p{constructor(){super(),this.currentIndex=0}deactivateElement(t){t.setAttribute("tabindex","-1"),t.querySelector("my-item").setAttribute("state","")}activateElement(t){t.setAttribute("tabindex","0"),t.querySelector("my-item").setAttribute("state","--selected")}connectedCallback(){this.setAttribute("tabindex","0")}onFocus(t){for(const t of this.children[0].children)t===this.children[0].children[this.currentIndex]?this.activateElement(t):this.deactivateElement(t),t.addEventListener("click",e=>{u(t).forEach(t=>{this.deactivateElement(t)}),this.activateElement(t),this.onSubmit(e)})}onKeydown(t){const e=this.querySelector('[tabindex]:not([tabindex="-1"])'),n=u(e);this.currentIndex=m(e),13===t.keyCode&&this.onSubmit(t),38===t.keyCode&&(0===this.currentIndex?this.currentIndex=n.length-1:this.currentIndex-=1,n.forEach(t=>{m(t)===this.currentIndex?this.activateElement(t):this.deactivateElement(t)})),40===t.keyCode&&(this.currentIndex===n.length-1?this.currentIndex=0:this.currentIndex+=1,n.forEach(t=>{m(t)===this.currentIndex?this.activateElement(t):this.deactivateElement(t)}))}onSubmit(t){}},n([l("focus")],t.MyListComponent.prototype,"onFocus",null),n([l("keydown")],t.MyListComponent.prototype,"onKeydown",null),t.MyListComponent=n([a({selector:"my-list",template:o`<slot name=menu></slot>`,style:s`:host{display:block;background:#181818;width:200px;height:200px;color:#fff;padding:1em;border-radius:8px}`})],t.MyListComponent),customElements.define("my-list",t.MyListComponent),t.MyItemComponent=class extends p{constructor(){super()}onBang(t){"--selected"===this.getAttribute("state")?this.setAttribute("state",""):this.setAttribute("state","--selected")}},n([l("bang","default")],t.MyItemComponent.prototype,"onBang",null),t.MyItemComponent=n([a({selector:"my-item",template:o`<p><span><slot name=msg>item</slot></span></p>`,style:s`:host{display:block;cursor:pointer}:host([state='--selected']){background:#ff69b4;color:#000;font-weight:700}`})],t.MyItemComponent),customElements.define("my-item",t.MyItemComponent),t.HomeView=class extends p{constructor(){super()}onBang(t){console.log(t)}},n([l("bang")],t.HomeView.prototype,"onBang",null),t.HomeView=n([a({selector:"home-view",template:o`<h3>Custom Elements</h3><my-list><ul slot=menu><li><my-item><span slot=msg>Item 1</span></my-item></li><li><my-item><span slot=msg>Item 2</span></my-item></li><li><my-item><span slot=msg>Item 3</span></my-item></li><li><my-item><span slot=msg>Item 4</span></my-item></li></ul></my-list><br><br><button is=my-button></button> <input is=my-input type=text> <a href=/chapter-1>Link</a>`,style:s`[tabindex],button,input{transition-property:box-shadow,border;transition-duration:300ms;transition-timing-function:ease-in-out}button,input{color:#fff;font-size:.8em;padding:10px;box-sizing:border-box;text-decoration:none;border-radius:4px;box-shadow:0 0 0 transparent;border:1px solid transparent;outline:0}ul{padding:0;margin:0;list-style:none;-webkit-margin-start:0;-webkit-margin-end:0;-webkit-padding-start:0;-webkit-margin-before:0;-webkit-margin-after:0}[tabindex]{outline:1px solid transparent}:focus,button:focus,input:focus{box-shadow:0 0 0 #ff69b4;outline:1px solid #ff69b4}[is=my-button]{background:#181818;cursor:pointer;color:#fff;font-weight:400}[is=my-input]{background:#181818;border:0;color:#fff}`})],t.HomeView),customElements.define("home-view",t.HomeView),t.ChapterOneView=class extends p{constructor(){super()}},t.ChapterOneView=n([a({selector:"chapter1-view",template:o`<h3>Another View</h3><a href=/ >Home</a>`,style:s``})],t.ChapterOneView),customElements.define("chapter1-view",t.ChapterOneView);(new class{constructor(){this.routes=[]}configureRouter(t,n){this.routes=t||e,this.rootSelector=n||(this.rootSelector?this.rootSelector:"#app");const o=document.querySelector(this.rootSelector);new Router(o).setRoutes(this.routes)}bootstrap(t){return this.configureRouter(e,t),this}}).bootstrap();return t}({});
//# sourceMappingURL=main.js.map
